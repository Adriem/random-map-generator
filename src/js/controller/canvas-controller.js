var CanvasController, Color, wall;

Color = {
  GRID: "#211",
  BACKGROUND: "#fff",
  WALL: "#200",
  GROUND: "#622",
  DOOR: "#400",
  DOOR: "#844",
  DEBUG: "#0F0",
  START_POINT: "#450"
};

wall = ['NONE', 'TILE', 'COMPOSED'];

CanvasController = (function() {
  function CanvasController(id) {
    this.id = id;
    this.canvas = $('#' + this.id)[0].getContext("2d");
  }

  CanvasController.prototype.getWidth = function() {
    return parseInt($('#' + this.id).attr("width"));
  };

  CanvasController.prototype.calculateTileSize = function(numberOfTiles) {
    return Math.floor(this.getWidth() / numberOfTiles);
  };

  CanvasController.prototype.calculateGridWidth = function(tileSize) {
    return Math.floor(tileSize / 10);
  };

  CanvasController.prototype.calculateWallSize = function(tileSize) {
    return Math.floor(tileSize / 3);
  };

  CanvasController.prototype.drawMap = function(tilemap, drawGrid, showWalls) {
    var i, j, ref, ref1, tileSize, x, y;
    if (drawGrid == null) {
      drawGrid = true;
    }
    if (showWalls == null) {
      showWalls = true;
    }
    tileSize = this.calculateTileSize(tilemap.width);
    this.canvas.fillStyle = Color.BACKGROUND;
    this.canvas.fillRect(0, 0, this.getWidth(), this.getWidth());
    for (y = i = 0, ref = tilemap.height; 0 <= ref ? i < ref : i > ref; y = 0 <= ref ? ++i : --i) {
      for (x = j = 0, ref1 = tilemap.width; 0 <= ref1 ? j < ref1 : j > ref1; x = 0 <= ref1 ? ++j : --j) {
        switch (tilemap[x][y]) {
          case Tile.FIRST_ROOM:
            this.drawTile(x, y, tileSize, Color.START_POINT);
            break;
          case Tile.GROUND:
            this.drawTile(x, y, tileSize, Color.GROUND);
            break;
          case Tile.WALL:
            if (wall[showWalls] === 'TILE') {
              this.drawTile(x, y, tileSize, Color.WALL);
            } else if (wall[showWalls] === 'COMPOSED') {
              this.drawWall(x, y, tileSize, Color.WALL, tilemap);
            }
            break;
          case Tile.DOOR:
            this.drawTile(x, y, tileSize, Color.DOOR);
        }
      }
    }
    if (drawGrid) {
      return this.drawGrid(tilemap);
    }
  };

  CanvasController.prototype.drawTile = function(x, y, size, value) {
    this.canvas.fillStyle = value;
    return this.canvas.fillRect(x * size, y * size, size, size);
  };

  CanvasController.prototype.drawWall = function(x, y, size, value, tilemap) {
    var flags, wallSize;
    flags = {
      north: !tilemap.is(x, y - 1, 1, 1, Tile.EMPTY) && !tilemap.is(x, y - 1, 1, 1, Tile.WALL) && y > 1,
      south: !tilemap.is(x, y + 1, 1, 1, Tile.EMPTY) && !tilemap.is(x, y + 1, 1, 1, Tile.WALL) && y < tilemap.height - 1,
      east: !tilemap.is(x + 1, y, 1, 1, Tile.EMPTY) && !tilemap.is(x + 1, y, 1, 1, Tile.WALL) && x < tilemap.width - 1,
      west: !tilemap.is(x - 1, y, 1, 1, Tile.EMPTY) && !tilemap.is(x - 1, y, 1, 1, Tile.WALL) && x > 1,
      northwest: !tilemap.is(x - 1, y - 1, 1, 1, Tile.EMPTY) && !tilemap.is(x - 1, y - 1, 1, 1, Tile.WALL) && y > 1 && x > 1,
      northeast: !tilemap.is(x + 1, y - 1, 1, 1, Tile.EMPTY) && !tilemap.is(x + 1, y - 1, 1, 1, Tile.WALL) && y > 1 && x < tilemap.width - 1,
      southwest: !tilemap.is(x - 1, y + 1, 1, 1, Tile.EMPTY) && !tilemap.is(x - 1, y + 1, 1, 1, Tile.WALL) && y < tilemap.height - 1 && x > 1,
      southeast: !tilemap.is(x + 1, y + 1, 1, 1, Tile.EMPTY) && !tilemap.is(x + 1, y + 1, 1, 1, Tile.WALL) && y < tilemap.height - 1 && x < tilemap.width - 1
    };
    wallSize = this.calculateWallSize(size);
    this.canvas.fillStyle = value;
    if (flags.north) {
      this.canvas.fillRect(x * size, y * size, size, wallSize);
    }
    if (flags.south) {
      this.canvas.fillRect(x * size, (y + 1) * size - wallSize, size, wallSize);
    }
    if (flags.east) {
      this.canvas.fillRect((x + 1) * size - wallSize, y * size, wallSize, size);
    }
    if (flags.west) {
      this.canvas.fillRect(x * size, y * size, wallSize, size);
    }
    if (flags.northwest) {
      this.canvas.fillRect(x * size, y * size, wallSize, wallSize);
    }
    if (flags.northeast) {
      this.canvas.fillRect((x + 1) * size - wallSize, y * size, wallSize, wallSize);
    }
    if (flags.southeast) {
      this.canvas.fillRect((x + 1) * size - wallSize, (y + 1) * size - wallSize, wallSize, wallSize);
    }
    if (flags.southwest) {
      return this.canvas.fillRect(x * size, (y + 1) * size - wallSize, wallSize, wallSize);
    }
  };

  CanvasController.prototype.drawGrid = function(tilemap) {
    var i, ref, tileSize, x;
    tileSize = this.calculateTileSize(tilemap.width);
    this.canvas.beginPath();
    this.canvas.strokeStyle = Color.GRID;
    for (x = i = 0, ref = tilemap.width; 0 <= ref ? i <= ref : i >= ref; x = 0 <= ref ? ++i : --i) {
      this.canvas.moveTo(x * tileSize, 0);
      this.canvas.lineTo(x * tileSize, tilemap.width * tileSize);
      this.canvas.moveTo(0, x * tileSize);
      this.canvas.lineTo(tilemap.width * tileSize, x * tileSize);
    }
    this.canvas.lineWidth = this.calculateGridWidth(tileSize);
    this.canvas.stroke();
    return this.canvas.closePath();
  };

  return CanvasController;

})();

this.CanvasController = CanvasController;

this.wallStyle = wall;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRyb2xsZXIvY2FudmFzLWNvbnRyb2xsZXIuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUlBLElBQUE7O0FBQUEsS0FBQSxHQUNFO0VBQUEsSUFBQSxFQUFNLE1BQU47RUFDQSxVQUFBLEVBQVksTUFEWjtFQUtBLElBQUEsRUFBTSxNQUxOO0VBTUEsTUFBQSxFQUFRLE1BTlI7RUFPQSxJQUFBLEVBQU0sTUFQTjtFQVFBLElBQUEsRUFBTSxNQVJOO0VBU0EsS0FBQSxFQUFPLE1BVFA7RUFhQSxXQUFBLEVBQWEsTUFiYjs7O0FBZ0JGLElBQUEsR0FBTyxDQUFDLE1BQUQsRUFBUyxNQUFULEVBQWlCLFVBQWpCOztBQUdEO0VBRVMsMEJBQUMsRUFBRDtJQUFDLElBQUMsQ0FBQSxLQUFEO0lBQVEsSUFBQyxDQUFBLE1BQUQsR0FBVSxDQUFBLENBQUUsR0FBQSxHQUFNLElBQUMsQ0FBQSxFQUFULENBQWEsQ0FBQSxDQUFBLENBQUUsQ0FBQyxVQUFoQixDQUEyQixJQUEzQjtFQUFuQjs7NkJBRWIsUUFBQSxHQUFVLFNBQUE7V0FBTSxRQUFBLENBQVMsQ0FBQSxDQUFFLEdBQUEsR0FBTSxJQUFDLENBQUEsRUFBVCxDQUFZLENBQUMsSUFBYixDQUFrQixPQUFsQixDQUFUO0VBQU47OzZCQUVWLGlCQUFBLEdBQW1CLFNBQUMsYUFBRDtzQkFBbUIsSUFBQyxDQUFBLFFBQUQsQ0FBQSxJQUFlO0VBQWxDOzs2QkFFbkIsa0JBQUEsR0FBb0IsU0FBQyxRQUFEO3NCQUFjLFdBQVk7RUFBMUI7OzZCQUVwQixpQkFBQSxHQUFtQixTQUFDLFFBQUQ7c0JBQWMsV0FBWTtFQUExQjs7NkJBRW5CLE9BQUEsR0FBUyxTQUFDLE9BQUQsRUFBVSxRQUFWLEVBQTJCLFNBQTNCO0FBQ1AsUUFBQTs7TUFEaUIsV0FBVzs7O01BQU0sWUFBWTs7SUFDOUMsUUFBQSxHQUFXLElBQUMsQ0FBQSxpQkFBRCxDQUFtQixPQUFPLENBQUMsS0FBM0I7SUFDWCxJQUFDLENBQUEsTUFB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Ozs7O0FBY1osSUFBSSxDQUFDLGdCQUFMLEdBQXdCOztBQUN4QixJQUFJLENBQUMsU0FBTCxHQUFpQiIsImZpbGUiOiJjb250cm9sbGVyL2NhbnZhcy1jb250cm9sbGVyLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIiwic291cmNlc0NvbnRlbnQiOlsiIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuIyAgVGhpcyBmaWxlIGRlZmluZXMgdGhlIGNvbnRyb2xsZXIgYW5kIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBjYW52YXNcclxuIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbkNvbG9yID1cclxuICBHUklEOiBcIiMyMTFcIlxyXG4gIEJBQ0tHUk9VTkQ6IFwiI2ZmZlwiXHJcbiAgIyBXQUxMOiBcIiNhOTlcIlxyXG4gICMgV0FMTDogXCIjYTExXCJcclxuICAjIFdBTEw6IFwiI2U2MFwiXHJcbiAgV0FMTDogXCIjMjAwXCJcclxuICBHUk9VTkQ6IFwiIzYyMlwiXHJcbiAgRE9PUjogXCIjNDAwXCJcclxuICBET09SOiBcIiM4NDRcIlxyXG4gIERFQlVHOiBcIiMwRjBcIlxyXG4gICMgU1RBUlRfUE9JTlQ6IFwiIzRBM1wiXHJcbiAgIyBTVEFSVF9QT0lOVDogXCIjMTYwXCJcclxuICAjIFNUQVJUX1BPSU5UOiBcIiMxNTBcIlxyXG4gIFNUQVJUX1BPSU5UOiBcIiM0NTBcIlxyXG4gICMgU1RBUlRfUE9JTlQ6IFwiIzU0MFwiXHJcblxyXG53YWxsID0gWydOT05FJywgJ1RJTEUnLCAnQ09NUE9TRUQnXVxyXG5cclxuXHJcbmNsYXNzIENhbnZhc0NvbnRyb2xsZXJcclxuXHJcbiAgY29uc3RydWN0b3I6IChAaWQpIC0+IEBjYW52YXMgPSAkKCcjJyArIEBpZClbMF0uZ2V0Q29udGV4dChcIjJkXCIpXHJcblxyXG4gIGdldFdpZHRoOiAoKSAtPiBwYXJzZUludCAkKCcjJyArIEBpZCkuYXR0cihcIndpZHRoXCIpXHJcblxyXG4gIGNhbGN1bGF0ZVRpbGVTaXplOiAobnVtYmVyT2ZUaWxlcykgLT4gQGdldFdpZHRoKCkgLy8gbnVtYmVyT2ZUaWxlc1xyXG5cclxuICBjYWxjdWxhdGVHcmlkV2lkdGg6ICh0aWxlU2l6ZSkgLT4gdGlsZVNpemUgLy8gMTBcclxuXHJcbiAgY2FsY3VsYXRlV2FsbFNpemU6ICh0aWxlU2l6ZSkgLT4gdGlsZVNpemUgLy8gM1xyXG5cclxuICBkcmF3TWFwOiAodGlsZW1hcCwgZHJhd0dyaWQgPSB0cnVlLCBzaG93V2FsbHMgPSB0cnVlKSAtPlxyXG4gICAgdGlsZVNpemUgPSBAY2FsY3VsYXRlVGlsZVNpemUodGlsZW1hcC53aWR0aClcclxuICAgIEBjYW52YXMuZmlsbFN0eWxlID0gQ29sb3IuQkFDS0dST1VORFxyXG4gICAgQGNhbnZhcy5maWxsUmVjdCgwLCAwLCBAZ2V0V2lkdGgoKSwgQGdldFdpZHRoKCkpXHJcbiAgICBmb3IgeSBpbiBbMC4uLnRpbGVtYXAuaGVpZ2h0XSB0aGVuIGZvciB4IGluIFswLi4udGlsZW1hcC53aWR0aF1cclxuICAgICAgc3dpdGNoIHRpbGVtYXBbeF1beV1cclxuICAgICAgICB3aGVuIFRpbGUuRklSU1RfUk9PTSB0aGVuIEBkcmF3VGlsZSh4LCB5LCB0aWxlU2l6ZSwgQ29sb3IuU1RBUlRfUE9JTlQpXHJcbiAgICAgICAgd2hlbiBUaWxlLkdST1VORCB0aGVuIEBkcmF3VGlsZSh4LCB5LCB0aWxlU2l6ZSwgQ29sb3IuR1JPVU5EKVxyXG4gICAgICAgIHdoZW4gVGlsZS5XQUxMXHJcbiAgICAgICAgICBpZiB3YWxsW3Nob3dXYWxsc10gaXMgJ1RJTEUnXHJcbiAgICAgICAgICAgIEBkcmF3VGlsZSh4LCB5LCB0aWxlU2l6ZSwgQ29sb3IuV0FMTClcclxuICAgICAgICAgIGVsc2UgaWYgd2FsbFtzaG93V2FsbHNdIGlzICdDT01QT1NFRCdcclxuICAgICAgICAgICAgQGRyYXdXYWxsKHgsIHksIHRpbGVTaXplLCBDb2xvci5XQUxMLCB0aWxlbWFwKVxyXG4gICAgICAgIHdoZW4gVGlsZS5ET09SIHRoZW4gQGRyYXdUaWxlKHgsIHksIHRpbGVTaXplLCBDb2xvci5ET09SKVxyXG4gICAgQGRyYXdHcmlkKHRpbGVtYXApIGlmIGRyYXdHcmlkXHJcblxyXG4gIGRyYXdUaWxlOiAoeCwgeSwgc2l6ZSwgdmFsdWUpIC0+XHJcbiAgICBAY2FudmFzLmZpbGxTdHlsZSA9IHZhbHVlXHJcbiAgICBAY2FudmFzLmZpbGxSZWN0KHggKiBzaXplLCB5ICogc2l6ZSwgc2l6ZSwgc2l6ZSlcclxuXHJcbiAgZHJhd1dhbGw6ICh4LCB5LCBzaXplLCB2YWx1ZSwgdGlsZW1hcCkgLT5cclxuICAgIGZsYWdzID1cclxuICAgICAgbm9ydGg6IG5vdCB0aWxlbWFwLmlzKHgsIHkgLSAxLCAxLCAxLCBUaWxlLkVNUFRZKSBhbmRcclxuICAgICAgICAgICAgIG5vdCB0aWxlbWFwLmlzKHgsIHkgLSAxLCAxLCAxLCBUaWxlLldBTEwpIGFuZCB5ID4gMVxyXG4gICAgICBzb3V0aDogbm90IHRpbGVtYXAuaXMoeCwgeSArIDEsIDEsIDEsIFRpbGUuRU1QVFkpIGFuZFxyXG4gICAgICAgICAgICAgbm90IHRpbGVtYXAuaXMoeCwgeSArIDEsIDEsIDEsIFRpbGUuV0FMTClhbmQgeSA8IHRpbGVtYXAuaGVpZ2h0IC0gMVxyXG4gICAgICBlYXN0OiBub3QgdGlsZW1hcC5pcyh4ICsgMSwgeSwgMSwgMSwgVGlsZS5FTVBUWSkgYW5kXHJcbiAgICAgICAgICAgIG5vdCB0aWxlbWFwLmlzKHggKyAxLCB5LCAxLCAxLCBUaWxlLldBTEwpIGFuZCB4IDwgdGlsZW1hcC53aWR0aCAtIDFcclxuICAgICAgd2VzdDogbm90IHRpbGVtYXAuaXMoeCAtIDEsIHksIDEsIDEsIFRpbGUuRU1QVFkpIGFuZFxyXG4gICAgICAgICAgICBub3QgdGlsZW1hcC5pcyh4IC0gMSwgeSwgMSwgMSwgVGlsZS5XQUxMKSBhbmQgeCA+IDFcclxuICAgICAgbm9ydGh3ZXN0OiBub3QgdGlsZW1hcC5pcyh4IC0gMSwgeSAtIDEsIDEsIDEsIFRpbGUuRU1QVFkpIGFuZFxyXG4gICAgICAgICAgICAgICAgIG5vdCB0aWxlbWFwLmlzKHggLSAxLCB5IC0gMSwgMSwgMSwgVGlsZS5XQUxMKSBhbmRcclxuICAgICAgICAgICAgICAgICB5ID4gMSBhbmQgeCA+IDFcclxuICAgICAgbm9ydGhlYXN0OiBub3QgdGlsZW1hcC5pcyh4ICsgMSwgeSAtIDEsIDEsIDEsIFRpbGUuRU1QVFkpIGFuZFxyXG4gICAgICAgICAgICAgICAgIG5vdCB0aWxlbWFwLmlzKHggKyAxLCB5IC0gMSwgMSwgMSwgVGlsZS5XQUxMKSBhbmRcclxuICAgICAgICAgICAgICAgICB5ID4gMSBhbmQgeCA8IHRpbGVtYXAud2lkdGggLSAxXHJcbiAgICAgIHNvdXRod2VzdDogbm90IHRpbGVtYXAuaXMoeCAtIDEsIHkgKyAxLCAxLCAxLCBUaWxlLkVNUFRZKSBhbmRcclxuICAgICAgICAgICAgICAgICBub3QgdGlsZW1hcC5pcyh4IC0gMSwgeSArIDEsIDEsIDEsIFRpbGUuV0FMTCkgYW5kXHJcbiAgICAgICAgICAgICAgICAgeSA8IHRpbGVtYXAuaGVpZ2h0IC0gMSBhbmQgeCA+IDFcclxuICAgICAgc291dGhlYXN0OiBub3QgdGlsZW1hcC5pcyh4ICsgMSwgeSArIDEsIDEsIDEsIFRpbGUuRU1QVFkpIGFuZFxyXG4gICAgICAgICAgICAgICAgIG5vdCB0aWxlbWFwLmlzKHggKyAxLCB5ICsgMSwgMSwgMSwgVGlsZS5XQUxMKSBhbmRcclxuICAgICAgICAgICAgICAgICB5IDwgdGlsZW1hcC5oZWlnaHQgLSAxIGFuZCB4IDwgdGlsZW1hcC53aWR0aCAtIDFcclxuICAgIHdhbGxTaXplID0gQGNhbGN1bGF0ZVdhbGxTaXplKHNpemUpXHJcbiAgICBAY2FudmFzLmZpbGxTdHlsZSA9IHZhbHVlXHJcbiAgICBAY2FudmFzLmZpbGxSZWN0KHgqc2l6ZSwgeSpzaXplLCBzaXplLCB3YWxsU2l6ZSkgaWYgZmxhZ3Mubm9ydGhcclxuICAgIEBjYW52YXMuZmlsbFJlY3QoeCpzaXplLCAoeSsxKSpzaXplLXdhbGxTaXplLCBzaXplLCB3YWxsU2l6ZSkgaWYgZmxhZ3Muc291dGhcclxuICAgIEBjYW52YXMuZmlsbFJlY3QoKHgrMSkqc2l6ZS13YWxsU2l6ZSwgeSpzaXplLCB3YWxsU2l6ZSwgc2l6ZSkgaWYgZmxhZ3MuZWFzdFxyXG4gICAgQGNhbnZhcy5maWxsUmVjdCh4KnNpemUsIHkqc2l6ZSwgd2FsbFNpemUsIHNpemUpIGlmIGZsYWdzLndlc3RcclxuICAgIEBjYW52YXMuZmlsbFJlY3QoeCpzaXplLCB5KnNpemUsIHdhbGxTaXplLCB3YWxsU2l6ZSkgaWYgZmxhZ3Mubm9ydGh3ZXN0XHJcbiAgICBAY2FudmFzLmZpbGxSZWN0KCh4KzEpKnNpemUtd2FsbFNpemUsIHkqc2l6ZSxcclxuICAgICAgICB3YWxsU2l6ZSwgd2FsbFNpemUpIGlmIGZsYWdzLm5vcnRoZWFzdFxyXG4gICAgQGNhbnZhcy5maWxsUmVjdCgoeCsxKSpzaXplLXdhbGxTaXplLCAoeSsxKSpzaXplLXdhbGxTaXplLFxyXG4gICAgICAgIHdhbGxTaXplLCB3YWxsU2l6ZSkgaWYgZmxhZ3Muc291dGhlYXN0XHJcbiAgICBAY2FudmFzLmZpbGxSZWN0KHggKiBzaXplLCAoeSArIDEpICogc2l6ZSAtIHdhbGxTaXplLFxyXG4gICAgICAgIHdhbGxTaXplLCB3YWxsU2l6ZSkgaWYgZmxhZ3Muc291dGh3ZXN0XHJcblxyXG4gIGRyYXdHcmlkOiAodGlsZW1hcCkgLT5cclxuICAgIHRpbGVTaXplID0gQGNhbGN1bGF0ZVRpbGVTaXplKHRpbGVtYXAud2lkdGgpXHJcbiAgICBAY2FudmFzLmJlZ2luUGF0aCgpXHJcbiAgICBAY2FudmFzLnN0cm9rZVN0eWxlID0gQ29sb3IuR1JJRFxyXG4gICAgZm9yIHggaW4gWzAuLnRpbGVtYXAud2lkdGhdICAjIFdlIGFzc3VtZSB0aWxlbWFwIHRvIGJlIHNxdWFyZWRcclxuICAgICAgQGNhbnZhcy5tb3ZlVG8oeCAqIHRpbGVTaXplLCAwKVxyXG4gICAgICBAY2FudmFzLmxpbmVUbyh4ICogdGlsZVNpemUsIHRpbGVtYXAud2lkdGggKiB0aWxlU2l6ZSlcclxuICAgICAgQGNhbnZhcy5tb3ZlVG8oMCwgeCAqIHRpbGVTaXplKVxyXG4gICAgICBAY2FudmFzLmxpbmVUbyh0aWxlbWFwLndpZHRoICogdGlsZVNpemUsIHggKiB0aWxlU2l6ZSlcclxuICAgIEBjYW52YXMubGluZVdpZHRoID0gQGNhbGN1bGF0ZUdyaWRXaWR0aCh0aWxlU2l6ZSlcclxuICAgIEBjYW52YXMuc3Ryb2tlKClcclxuICAgIEBjYW52YXMuY2xvc2VQYXRoKClcclxuXHJcbiMgTWFrZSBDYW52YXNDb250cm9sbGVyIGF2YWlsYWJsZSBnbG9iYWxseVxyXG50aGlzLkNhbnZhc0NvbnRyb2xsZXIgPSBDYW52YXNDb250cm9sbGVyXHJcbnRoaXMud2FsbFN0eWxlID0gd2FsbFxyXG4iXX0=